# Zakupki

Программа для сбора информации с сайта [zakupki.gov.ru](https://zakupki.gov.ru)

## Использование

Программа создаёт файл `zakupki.xlsx`. Он используется для:

- сохранения в нём статус выполненных, невыполненных задач (при запуске без параметров командной строки программа будет пытаться выполнить отложенные задачи);
- сохранят в него найденную информацию (данные о торгах);
- получает из него информацию о торгах, по которым пользователь желает получить дополнительную информацию.

Сбор данных проходит в три этапа.

- На первом этапе программа получает от пользователя в командной строке ИНН организации и годы, за которые надо собирать данные. 
Она загружает данные обо всех торгах этого заказчика (кроме исключенных из-за наличия слов из черного списка - это позволяет отсечь заведом не нужные лоты).
Пример запуска: `python zakupki.py -i 2311040088 -y 2020 2021`. Это поиск всех торгов для организации с ИНН 2311040088 за период 2020-2021 годы.
- Сбор всех лотов по ИНН и годам можно повторять многократно, даже если уже выполнялись запуски программы по второму и третьему этапам сбора данных
- Если были ошибки (сайт zakupki.gov.ru не ответил на все запросы) - программу надо запустить вновь, без параметров (режим завершения отложенных заданий). На вкладке `jobs` файла `zakupki.xlsx` у выполненных заданий стоит статус `done`, если у какого-то задания стоит статус `error`, надо запустить программу ещё раз. 
- После этого файл `zakupki.xlsx` надо открыть в редакторе (например, в Excel); в нём нужно удалить строки с ненужными лотами, упорядочивать их как угодно, добавлять колонки. Этот этап нужен для удаления заведомо не интересных лотов, с учетом специфики данного клиента (как у него принято называть торги с интересующим нас товаром)
- Запускаем программу снова. но уже для второго этапа: `zakupki.py 2`. Программа соберет дополнительную информацию по всем неудаленным лотам, и также добавит её в файл `zakupki.xlsx`. В случае успешного сбора информации по конкретному лоту, в колонке `stage2` появится статус `done`. При ошибках сбора данных (не все лоты перешли в данный статус) - программу также можно запустить повторно для второго этапа.

## Использованные библиотеки:

- [openpyxl](https://openpyxl.readthedocs.io/en/stable/) - Чтение/запись фалов Excel 2010 xlsx/xlsm
- [Beautiful Soup](https://pypi.org/project/beautifulsoup4/) - Парсинг HTML и XML документов
- [requests](https://docs.python-requests.org/en/latest/index.html) - Выполнение HTTP-запросов
